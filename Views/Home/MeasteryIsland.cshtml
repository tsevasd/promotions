@{
    const string imgUrl = "/img/prizes/measteryisland";
    const string cb = "?cb=1";

    //string drawUrl = Url.RouteUrl("MeasteryIslandApp_Play_Draw");
}
<style>
    .play {
        background-color: #ffffff;
        height: 800px;
        overflow: hidden;
        position: relative;
        width: 100%;
    }

    .play img {
        max-width: none;
    }

    .play .bg-intro,
    .play .bg {
        left: 50%;
        position: absolute;
        top: 0;
        transform: translateX(-50%);
        transition: opacity .1s ease .9s;
        z-index: 1;
    }

    .play .bg {
        opacity: 0;
        z-index: 2;
    }

    .play.loaded .bg-intro {
        opacity: 0;
    }

    .play.loaded .bg {
        opacity: 1;
    }

    .bg-front {
        bottom: 0;
        left: 50%;
        opacity: 0;
        position: absolute;
        transform: translateX(-50%);
        transition: opacity .1s ease .9s;
        z-index: 5;
    }

    .loaded .bg-front {
        opacity: 1;
    }

    .load-spinner {
        animation: spinning .5s linear infinite;
        border-top: 4px solid #fff;
        border-radius: 560px;
        height: 560px;
        left: 50%;
        margin-left: -280px;
        position: absolute;
        top: 120px;
        width: 560px;
    }

    .play.loaded .load-spinner {
        display: none;
    }

    @@keyframes spinning {
        0% {
            transform: rotate(0deg)
        }

        100% {
            transform: rotate(360deg)
        }
    }

    .betshop {
        left: 50%;
        margin-left: -186px;
        opacity: 0;
        position: absolute;
        top: 288px;
        transition: all .5s;
        z-index: 8;
    }

    .start .betshop {
        opacity: 1;
    }

    .logo1 {
        left: 50%;
        margin-left: -228px;
        opacity: 0;
        position: absolute;
        top: 320px;
        transform: scale(.6, 1);
        transition: all .5s ease .15s;
        z-index: 6;
    }

    .start .logo1 {
        opacity: 1;
        transform: scale(1, 1);
    }

    .logo2 {
        left: 50%;
        margin-left: -105px;
        opacity: 0;
        position: absolute;
        top: 384px;
        transform: scale(.6, 1);
        transition: all .5s ease .3s;
        z-index: 7;
    }

    .start .logo2 {
        opacity: 1;
        transform: scale(1, 1);
    }

    .play.loaded .betshop {
        top: 26px;
    }

    .play.loaded .logo1 {
        top: 58px;
    }

    .play.loaded .logo2 {
        top: 122px;
    }

    .intro-cover {
        background: rgb(209, 234, 249);
        background: linear-gradient(0deg, rgba(209, 234, 249, 0) 0%, rgba(209, 234, 249, 1) 50%, rgba(209, 234, 249, 1) 100%);
        height: 1600px;
        left: 0;
        opacity: 0;
        position: absolute;
        top: 0;
        transition: opacity .4s, top 2s ease .5s;
        width: 100%;
        z-index: 5;
    }

    .loaded .intro-cover {
        opacity: 1;
        top: -1600px;
    }

    .statues {
        bottom: 52px;
        height: 482px;
        left: 50%;
        position: absolute;
        transform: translateX(-50%);
        width: 740px;
        z-index: 4;
    }

    @@keyframes flashing {

        0%,
        40%,
        100% {
            filter: brightness(1) contrast(1)
        }

        20% {
            filter: brightness(1.5) contrast(.75)
        }
    }

    .loaded .statue-1 img {
        animation: flashing 2s infinite 4.5s
    }

    .loaded .statue-2 img {
        animation: flashing 2s infinite 4.7s
    }

    .loaded .statue-3 img {
        animation: flashing 2s infinite 4.9s
    }

    .statue {
        bottom: -534px;
        cursor: pointer;
        display: block;
        height: 482px;
        position: absolute;
        transition: bottom 3s ease-out 1.1s, background .3s, left .5s;
        width: 230px;
        z-index: 1;
    }

    .no-touch .statue:hover {
        background-color: rgba(255, 255, 255, .3);
    }

    .loaded.fetching .statue {
        pointer-events: none
    }

    .statue-1 {
        left: 0px
    }

    .statue-2 {
        left: 255px;
    }

    .statue-3 {
        left: 510px;
    }

    .loaded .statue {
        animation: shaking 3s ease forwards 1.1s;
        bottom: 0px
    }

    @@keyframes shaking {

        0%,
        100% {
            margin-left: 0px
        }

        4%,
        8%,
        12%,
        16%,
        20%,
        24%,
        28%,
        32%,
        36%,
        40%,
        44%,
        48%,
        52%,
        56%,
        60%,
        64%,
        68%,
        72%,
        76%,
        80%,
        84%,
        88% {
            margin-left: -5px
        }

        92%,
        96% {
            margin-left: -2px
        }

        2%,
        6%,
        10%,
        14%,
        18%,
        22%,
        26%,
        30%,
        34%,
        38%,
        42%,
        46%,
        50%,
        54%,
        58%,
        62%,
        66%,
        70%,
        74%,
        78%,
        82%,
        86%,
        90% {
            margin-left: 5px
        }

        94%,
        98% {
            margin-left: 2px
        }
    }

    .loaded.fetching .statue img {
        animation: shaking 2.5s ease forwards 0s;
    }

    .loaded.fetching .statue {
        transition: bottom 2.5s ease-in, left .5s;
        bottom: -482px;
    }

    /*.loaded.fetching .statue img {
        animation: none;
    }*/

    .loaded.fetching .statue.selected {
        animation: none;
        bottom: 0px;
    }

    .loaded.fetching .statue.selected img {
        animation: flashing .5s infinite;
    }

    .loaded.fetched .statue.selected {
        left: 20px
    }

    .loaded.fetched .statue.selected img {
        animation: none
    }

    .win-scr {
        background-color: rgba(0, 0, 0, .8);
        border-radius: 20px;
        bottom: 15px;
        height: 485px;
        left: 250px;
        opacity: 0;
        padding: 20px;
        position: absolute;
        right: 10px;
        text-align: center;
        transition: all .4s ease .3s;
        transform: translateY(-40px) scale(.8);
        visibility: hidden;
        z-index: 2;
    }

    .fetched .win-scr {
        opacity: 1;
        transform: translateY(0px) scale(1);
        visibility: visible;
    }

    .win-scr .title {
        color: #189dd8;
        font-size: 36px;
        font-weight: bold;
        margin-bottom: 20px;
    }

    .win-scr.lost .title {
        color: #999
    }

    .win-scr .img {
        display: block;
        margin: 0 auto 24px;
        max-height: 160px;
    }

    .win-scr .text {
        color: #fff;
        font-size: 20px;
        font-weight: bold;
        line-height: 1.2;
        margin-bottom: 24px;
        padding: 0 20px;
    }

    .win-scr.login .text,
    .win-scr.expired .text {
        margin-top: 60px
    }

    .win-scr .button {
        background-color: #ffdd00;
        border-bottom: 3px solid #b29a00;
        border-radius: 160px;
        color: #044883;
        display: inline-block;
        font-size: 30px;
        font-weight: bold;
        margin: 0 auto;
        padding: 8px 30px 6px;
        white-space: nowrap;
    }

    .win-scr.login .title,
    .win-scr.login .img,
    .win-scr.lost .img,
    .win-scr.expired .img {
        display: none;
    }

    .fetched .win-link {
        bottom: 0;
        cursor: pointer;
        height: 100%;
        left: 0;
        position: absolute;
        right: 0;
        top: 0;
        width: 100%;
        z-index: 12;
    }


    @@media screen and (min-width:801px) and (max-width:1366px) {
        .play {
            height: 600px;
        }

        .play .screen-sm {
            position: absolute;
            height: 133.333%;
            width: 133.333%;
            transform: scale(.75) translate(-16.666%, -16.666%);
        }
    }


    @@media screen and (max-width:800px) {
        .play {
            height: 400px;
        }

        .play .screen-sm {
            position: absolute;
            height: 200%;
            width: 200%;
            transform: scale(.5) translate(-50%, -50%);
        }

        .loaded.fetched .statue.selected {
            left: -20px
        }

        .win-scr {
            left: 210px
        }

        .win-scr .title {
            font-size: 44px;
        }

        .win-scr .text {
            font-size: 30px;
            padding: 0px;
        }

        .win-scr .button {
            font-size: 33px;
            padding: 10px 38px 10px;
        }
    }

    @@media screen and (max-width:399px) {
        .statues {
            width: 680px;
        }

        .statue-2 {
            left: 225px;
        }

        .statue-3 {
            left: 450px;
        }
    }
</style>

<div class="play" id="play">
    <div class="screen-sm">
        <img class="intro" src="@(imgUrl)/bg_intro.webp@(cb)" />
        <img class="betshop" src="@(imgUrl)/betshop.webp@(cb)" />
        <img class="logo1" src="@(imgUrl)/logo1.webp@(cb)" />
        <img class="logo2" src="@(imgUrl)/logo2.webp@(cb)" />
        <div class="load-spinner"></div>
        <div class="intro-cover"></div>
        <img class="bg" src="@(imgUrl)/bg.webp@(cb)" />
        <img class="bg-front" src="@(imgUrl)/bg_front.webp@(cb)" />
        <div class="statues">
            <a class="statue statue-1 option">
                <img class="img" src="@(imgUrl)/statue1.webp@(cb)" />
            </a>
            <a class="statue statue-2 option">
                <img class="img" src="@(imgUrl)/statue2.webp@(cb)" />
            </a>
            <a class="statue statue-3 option">
                <img class="img" src="@(imgUrl)/statue3.webp@(cb)" />
            </a>
            <div class="win-scr" id="winContent">
                <div class="title" id="gameResultTitle"></div>
                <img class="img" id="winImg" src="" />
                <div class="text" id="gameResultMessage"></div>
                <div class="button" id="gameResultButton"></div>
            </div>
        </div>
    </div>
    <a class="win-link" id="winLink" href="https://www.betshop.gr/casino" target="_top"></a>
</div>

<script>
    const play = document.getElementById('play');
    const gameResultTitle = document.getElementById('gameResultTitle');
    const gameResultMessage = document.getElementById('gameResultMessage');
    const gameResultButton = document.getElementById('gameResultButton');
    const winContent = document.getElementById('winContent');
    const winLink = document.getElementById('winLink');
    const winImg = document.getElementById('winImg');

    if (!('ontouchstart' in window) && !(window.DocumentTouch && document instanceof DocumentTouch) && !(navigator.MaxTouchPoints > 0) && !(navigator.msMaxTouchPoints > 0)) {
        play.classList.add('no-touch');
    }

    setTimeout(function () { play.classList.add('start'); }, 30)

    window.addEventListener('load', () => {
        setTimeout(function () { play.classList.add('loaded'); }, 1500);
    });

    /* Actual function deactivated */
    /*const optionClickHandler = async (option) => {
        play.classList.add('fetching');
        option.classList.add('selected');

        try {
            const response = await fetch('@@drawUrl', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const answer = await response.json();

            gameResultTitle.innerHTML = answer.title;
            gameResultMessage.innerHTML = answer.text;
            gameResultButton.innerText = answer.button;
            winContent.classList.add(answer.state);
            winLink.href = answer.link;
            winImg.src = answer.game + '?cb=' + Math.floor(Math.random() * 101);
            setTimeout(function () {
                play.classList.add('fetched');
            }, 1800);
        } catch (e) {
            console.log(`There was a problem with the fetch operation: ${e.message}`);
            option.classList.remove('selected');
            play.classList.remove('fetching');
        }

    }*/

    /* Demo function */
    const optionClickHandler = async (option) => {
        play.classList.add('fetching');
        option.classList.add('selected');
        setTimeout(function(){

            gameResultTitle.innerHTML = 'Congratulations!';
            gameResultMessage.innerHTML = 'You just won 10 free spins at';
            gameResultButton.innerText = 'GOLD FISHY';
            winContent.classList.add('win');
            winLink.href = 'https://www.google.com';
            winImg.src = '/img/prizes/measteryisland/win_goldfishy.webp' + '?cb=' + Math.floor(Math.random() * 101);

            play.classList.add('fetched');
        }, 1500);
    }

    @*// add event listeners *@
        document.querySelectorAll('.option').forEach((option) => {
            option.addEventListener('click', function () {
                optionClickHandler(option);
            });
        });
</script>